<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Run sample size calculation for pilot data for reference dataset — runSampleCal • scClassify</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Run sample size calculation for pilot data for reference dataset — runSampleCal" />
<meta property="og:description" content="Run sample size calculation for pilot data for reference dataset" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scClassify</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Classify Your Cells
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/pretrainedModel.html">Prediction using pretrained model</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Build Your Own Models
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/scClassify.html">scClassify Model Building and Prediction</a>
    </li>
    <li>
      <a href="../articles/webOnly/sampleSizeCal.html">Sample size learning</a>
    </li>
    <li>
      <a href="../articles/webOnly/scClassify_TM_heart.html">Case study - Tabula Muris Heart</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Pretrained Models
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/webOnly/Tasic2016_mouseNeuronal.html">Tasic (2016) (Mouse neuronal)</a>
    </li>
    <li>
      <a href="../articles/webOnly/Tasic2018_mouseNeuronal.html">Tasic (2018) (Mouse neuronal)</a>
    </li>
    <li>
      <a href="../articles/webOnly/Hrvatin_mouseNeuronal.html">Hrvatin (Mouse neuronal)</a>
    </li>
    <li>
      <a href="../articles/webOnly/Cohen_mouseLung.html">Cohen (Mouse lung)</a>
    </li>
    <li>
      <a href="../articles/webOnly/Park_mouseKidney.html">Park (Mouse kidney)</a>
    </li>
    <li>
      <a href="../articles/webOnly/MacParlandres_humanLiver.html">MacParland (Human Liver)</a>
    </li>
    <li>
      <a href="../articles/webOnly/Aizarani_humanLiver.html">Aizarani (Human Liver)</a>
    </li>
    <li>
      <a href="../articles/webOnly/Baron_humanPancreas.html">Baron (Human Pancreas)</a>
    </li>
    <li>
      <a href="../articles/webOnly/Muraro_humanPancreas.html">Muraro (Human Pancreas)</a>
    </li>
    <li>
      <a href="../articles/webOnly/Lawlor_humanPancreas.html">Lawlor (Human Pancreas)</a>
    </li>
    <li>
      <a href="../articles/webOnly/Xin_humanPancreas.html">Xin (Human Pancreas)</a>
    </li>
    <li>
      <a href="../articles/webOnly/Wang_humanPancreas.html">Wang (Human Pancreas)</a>
    </li>
    <li>
      <a href="../articles/webOnly/Segerstolpe_humanPancreas.html">Segerstolpe (Human Pancreas)</a>
    </li>
    <li>
      <a href="../articles/webOnly/Joint_humanPancreas.html">Joint (Human Pancreas)</a>
    </li>
    <li>
      <a href="../articles/webOnly/Joint_humanPBMC.html">Joint (Human PBMC)</a>
    </li>
    <li>
      <a href="../articles/webOnly/Li_humanMelanoma.html">Li (Human Melanoma)</a>
    </li>
    <li>
      <a href="../articles/webOnly/TabulaMuris.html">Tabula Muris (Mouse cell atlas)</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://shiny.maths.usyd.edu.au/scClassify/">
    <span class="fa fa-star"></span>
     
    Interactive scClassify shiny app (beta)
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/SydneyBioX/scClassify">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run sample size calculation for pilot data for reference dataset</h1>
    <small class="dont-index">Source: <a href='https://github.com/SydneyBioX/scClassify/blob/master/R/sampleSizeCal.R'><code>R/sampleSizeCal.R</code></a></small>
    <div class="hidden name"><code>runSampleCal.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Run sample size calculation for pilot data for reference dataset</p>
    </div>

    <pre class="usage"><span class='fu'>runSampleCal</span>(
  <span class='no'>exprsMat</span>,
  <span class='no'>cellTypes</span>,
  <span class='kw'>n_list</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>20</span>, <span class='fl'>40</span>, <span class='fl'>60</span>, <span class='fl'>80</span>, <span class='fl'>100</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>200</span>, <span class='fl'>500</span>, <span class='fl'>100</span>)),
  <span class='kw'>num_repeat</span> <span class='kw'>=</span> <span class='fl'>20</span>,
  <span class='kw'>level</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>cellType_tree</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>BPPARAM</span> <span class='kw'>=</span> <span class='kw pkg'>BiocParallel</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html'>SerialParam</a></span>(),
  <span class='kw'>subset_test</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>num_test</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>exprsMat</th>
      <td><p>A matrix of expression matrix of pilot dataset
(log-transformed, or normalised)</p></td>
    </tr>
    <tr>
      <th>cellTypes</th>
      <td><p>A vector of cell types of pilot dataset</p></td>
    </tr>
    <tr>
      <th>n_list</th>
      <td><p>A vector of integer indicates the sample size to run.</p></td>
    </tr>
    <tr>
      <th>num_repeat</th>
      <td><p>An integer indicates the number of run for
each sample size will be repeated.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>An integer indicates the accuracy rate is calculate
based on the n-th level from top of cell type tree.
If it is NULL (by default), it will be the bottom of the cell type tree.
It can not be larger than the total number of levels of the tree.</p></td>
    </tr>
    <tr>
      <th>cellType_tree</th>
      <td><p>A list indicates the cell type tree (optional),
if it is NULL, the accuracy rate is calculate
based on the provided cellTypes.</p></td>
    </tr>
    <tr>
      <th>BPPARAM</th>
      <td><p>A <code>BiocParallelParam</code> class object
from the <code>BiocParallel</code> package is used. Default is SerialParam().</p></td>
    </tr>
    <tr>
      <th>subset_test</th>
      <td><p>A ogical input indicates whether we used a subset of data
(fixed number for each sample size)
to test instead of all remaining data. By default, it is FALSE.</p></td>
    </tr>
    <tr>
      <th>num_test</th>
      <td><p>An integer indicates the size of the test data.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other parameter from scClassify</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A matrix of accuracy matrix, where columns corresponding to different
sample sizes, rows corresponding to the number of repetation.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"scClassify_example"</span>)
<span class='no'>xin_cellTypes</span> <span class='kw'>&lt;-</span> <span class='no'>scClassify_example</span>$<span class='no'>xin_cellTypes</span>
<span class='no'>exprsMat_xin_subset</span> <span class='kw'>&lt;-</span> <span class='no'>scClassify_example</span>$<span class='no'>exprsMat_xin_subset</span>

<span class='no'>exprsMat_xin_subset</span> <span class='kw'>&lt;-</span> <span class='fu'>as</span>(<span class='no'>exprsMat_xin_subset</span>, <span class='st'>"dgCMatrix"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>2019</span>)
<span class='no'>accMat</span> <span class='kw'>&lt;-</span> <span class='fu'>runSampleCal</span>(<span class='no'>exprsMat_xin_subset</span>,
<span class='no'>xin_cellTypes</span>,
<span class='kw'>n_list</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>20</span>, <span class='fl'>100</span>, <span class='fl'>20</span>),
<span class='kw'>num_repeat</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>BPPARAM</span> <span class='kw'>=</span> <span class='kw pkg'>BiocParallel</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html'>SerialParam</a></span>())</div><div class='output co'>#&gt; [1] "n= 20"
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;     8     8     3     3 </div><div class='output co'>#&gt; <span class='message'>There are only 4 selected genes in reference data expressed in query data</span></div><div class='output co'>#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;     8     8     3     3 </div><div class='output co'>#&gt; <span class='message'>There are only 4 selected genes in reference data expressed in query data</span></div><div class='output co'>#&gt; <span class='message'>There are only 4 selected genes in reference data expressed in query data</span></div><div class='output co'>#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;     8     8     3     3 
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;     8     8     3     3 
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;     8     8     3     3 </div><div class='output co'>#&gt; <span class='message'>There are only 3 selected genes in reference data expressed in query data</span></div><div class='output co'>#&gt;                              [,1]        [,2]        [,3]       [,4]      [,5]
#&gt; correct                0.44631902 0.000000000 0.966257669 0.79294479 0.4079755
#&gt; correctly unassigned   0.00000000 0.000000000 0.000000000 0.00000000 0.0000000
#&gt; intermediate           0.51993865 0.957055215 0.015337423 0.01073620 0.3987730
#&gt; incorrectly unassigned 0.02147239 0.038343558 0.010736196 0.11349693 0.1932515
#&gt; error assigned         0.00000000 0.000000000 0.000000000 0.00000000 0.0000000
#&gt; misclassified          0.01226994 0.004601227 0.007668712 0.08282209 0.0000000
#&gt; [1] "n= 40"
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;    17    15     3     5 
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;    17    15     3     5 
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;    17    15     3     5 
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;    17    15     3     5 
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;    17    15     3     5 
#&gt;                               [,1]        [,2]       [,3]       [,4]
#&gt; correct                0.878548896 0.971608833 0.83596215 0.80757098
#&gt; correctly unassigned   0.000000000 0.000000000 0.00000000 0.00000000
#&gt; intermediate           0.031545741 0.011041009 0.00000000 0.00000000
#&gt; incorrectly unassigned 0.088328076 0.007886435 0.15299685 0.17192429
#&gt; error assigned         0.000000000 0.000000000 0.00000000 0.00000000
#&gt; misclassified          0.001577287 0.009463722 0.01104101 0.02050473
#&gt;                               [,5]
#&gt; correct                0.766561514
#&gt; correctly unassigned   0.000000000
#&gt; intermediate           0.009463722
#&gt; incorrectly unassigned 0.171924290
#&gt; error assigned         0.000000000
#&gt; misclassified          0.052050473
#&gt; [1] "n= 60"
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;    25    23     4     7 
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;    25    23     4     7 
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;    25    23     4     7 
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;    25    23     4     7 
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;    25    23     4     7 
#&gt;                               [,1]        [,2]        [,3]        [,4]
#&gt; correct                0.865040650 0.910569106 0.902439024 0.884552846
#&gt; correctly unassigned   0.000000000 0.000000000 0.000000000 0.000000000
#&gt; intermediate           0.000000000 0.000000000 0.001626016 0.001626016
#&gt; incorrectly unassigned 0.125203252 0.081300813 0.082926829 0.108943089
#&gt; error assigned         0.000000000 0.000000000 0.000000000 0.000000000
#&gt; misclassified          0.009756098 0.008130081 0.013008130 0.004878049
#&gt;                               [,5]
#&gt; correct                0.845528455
#&gt; correctly unassigned   0.000000000
#&gt; intermediate           0.001626016
#&gt; incorrectly unassigned 0.143089431
#&gt; error assigned         0.000000000
#&gt; misclassified          0.009756098
#&gt; [1] "n= 80"
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;    34    31     6     9 
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;    34    31     6     9 
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;    34    31     6     9 
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;    34    31     6     9 
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;    34    31     6     9 
#&gt;                               [,1]        [,2]       [,3]        [,4]
#&gt; correct                0.937710438 0.877104377 0.91919192 0.877104377
#&gt; correctly unassigned   0.000000000 0.000000000 0.00000000 0.000000000
#&gt; intermediate           0.003367003 0.000000000 0.00000000 0.000000000
#&gt; incorrectly unassigned 0.052188552 0.114478114 0.07070707 0.116161616
#&gt; error assigned         0.000000000 0.000000000 0.00000000 0.000000000
#&gt; misclassified          0.006734007 0.008417508 0.01010101 0.006734007
#&gt;                               [,5]
#&gt; correct                0.873737374
#&gt; correctly unassigned   0.000000000
#&gt; intermediate           0.001683502
#&gt; incorrectly unassigned 0.114478114
#&gt; error assigned         0.000000000
#&gt; misclassified          0.010101010
#&gt; [1] "n= 100"
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;    42    39     7    12 
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;    42    39     7    12 
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;    42    39     7    12 
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;    42    39     7    12 
#&gt; cellTypes_train
#&gt; alpha  beta delta gamma 
#&gt;    42    39     7    12 
#&gt;                              [,1]       [,2]        [,3]        [,4]       [,5]
#&gt; correct                0.89198606 0.91463415 0.951219512 0.979094077 0.89198606
#&gt; correctly unassigned   0.00000000 0.00000000 0.000000000 0.000000000 0.00000000
#&gt; intermediate           0.00000000 0.00000000 0.001742160 0.003484321 0.00000000
#&gt; incorrectly unassigned 0.09233449 0.07491289 0.040069686 0.010452962 0.09756098
#&gt; error assigned         0.00000000 0.00000000 0.000000000 0.000000000 0.00000000
#&gt; misclassified          0.01567944 0.01045296 0.006968641 0.006968641 0.01045296</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Yingxin Lin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


